<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  <title>ASP.NET MVC 视图 | luox78</title>
  <meta name="description" content="Blog for luox78" />
  <meta name="keywords" content="" />
  <meta name="HandheldFriendly" content="True" />
  <meta name="theme-color" content=" rgb(59,95,208)">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
  <link rel="shortcut icon" href="/images/dev.ico">
  <link rel="alternate" href="/atom.xml" title="luox78">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="设计并非外观怎样，感觉如何。设计是（解决）如何工作的问题  –Steve Jobs 视图引擎的结构与性能视图引擎是位浏览器生成html输出的组件 控制器—数据—&amp;gt;视图模板—–&amp;gt;html 视图引擎机制在asp.net mvc中，视图引擎只是一个实现固定接口（IViewEngine）的类。">
<meta name="keywords" content="ASP.NET MVC5 编程实战">
<meta property="og:type" content="article">
<meta property="og:title" content="ASP.NET MVC 视图">
<meta property="og:url" content="https://luox78.github.io/2018/02/13/ASP.NET-MVC-视图/index.html">
<meta property="og:site_name" content="luox78">
<meta property="og:description" content="设计并非外观怎样，感觉如何。设计是（解决）如何工作的问题  –Steve Jobs 视图引擎的结构与性能视图引擎是位浏览器生成html输出的组件 控制器—数据—&amp;gt;视图模板—–&amp;gt;html 视图引擎机制在asp.net mvc中，视图引擎只是一个实现固定接口（IViewEngine）的类。">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://luox78.github.io/images/操作调用程序时序图.png">
<meta property="og:updated_time" content="2018-03-03T15:12:31.128Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ASP.NET MVC 视图">
<meta name="twitter:description" content="设计并非外观怎样，感觉如何。设计是（解决）如何工作的问题  –Steve Jobs 视图引擎的结构与性能视图引擎是位浏览器生成html输出的组件 控制器—数据—&amp;gt;视图模板—–&amp;gt;html 视图引擎机制在asp.net mvc中，视图引擎只是一个实现固定接口（IViewEngine）的类。">
<meta name="twitter:image" content="https://luox78.github.io/images/操作调用程序时序图.png">
    
  <link href="https://fonts.googleapis.com/css?family=Inconsolata|Titillium+Web" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto+Mono" rel="stylesheet">
  <link href='//cdn.bootcss.com/node-waves/0.7.5/waves.min.css' rel='stylesheet'>
  <link rel="stylesheet" href="/style.css">
  <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
  </script>
</head>

<body>
  <div id="loading">
    <div id="loading-center">
    <div id="loading-center-absolute">
    <div class="object" id="object_one"></div>
    <div class="object" id="object_two"></div>
    <div class="object" id="object_three"></div>
    <div class="object" id="object_four"></div>
    <div class="object" id="object_five"></div>
    <div class="object" id="object_six"></div>
    <div class="object" id="object_seven"></div>
    <div class="object" id="object_eight"></div>
    <div class="object" id="object_big"></div>
    </div>
    </div>
     
    </div>
  <header class="l_header">
	<div class='wrapper'>
		<div class="nav-main container container--flex">
			<a class="logo flat-box" href='/' >
				luox78
			</a>
			<div class='menu'>
				<ul class='h-list'>
					
						<li>
							<a class='flat-box nav-home' href='/'>
								Home
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-archives' href='/archives'>
								Archives
							</a>
						</li>
					
						<li>
							<a class='flat-box nav-about' href='/about.html'>
								About
							</a>
						</li>
					
				</ul>
				<div class='underline'></div>
			</div>
			
				<div class="m_search">
					<form name="searchform" class="form u-search-form">
						<input type="text" class="input u-search-input" placeholder="Search" />
						<span class="icon icon-search"></span>
					</form>
				</div>
			
			<ul class='switcher h-list'>
				
					<li class='s-search'><a href='javascript:void(0)'><span class="icon icon-search flat-box"></span></a></li>
				
				<li class='s-menu'><a href='javascript:void(0)'><span class="icon icon-menu flat-box"></span></a></li>
			</ul>
		</div>
		
		<div class='nav-sub container container--flex'>
			<a class="logo" class="flat-box" href='javascript:void(0)'>
				Word of Forks
			</a>

			<ul class='switcher h-list'>
				<li class='s-comment'><a href='javascript:void(0)'><span class="icon icon-chat_bubble_outline flat-box"></span></a></li>
				<li class='s-top'><a href='javascript:void(0)'><span class="icon icon-arrow_upward flat-box"></span></a></li>
				<li class='s-toc'><a href='javascript:void(0)'><span class="icon icon-format_list_numbered flat-box"></span></a></li>
			</ul>
		</div>
	</div>
</header>
<aside class="menu-phone">
	<nav>
		
			<a href="/" class="nav-home nav">
				Home
			</a>
		
			<a href="/archives" class="nav-archives nav">
				Archives
			</a>
		
			<a href="/about.html" class="nav-about nav">
				About
			</a>
		
	</nav>
</aside>

  <div id="loading-bar-wrapper">
  <div id="loading-bar"></div>
</div>


  <!-- <script>
      var count=0;
      function setLoadingBarProgress() {
          if(count==100){
              count=0;
          }
          document.getElementById('loading-bar').style.width = count + "%";
      }
  </script> -->
  <div class="l_body">
    <div class='container clearfix'>
      <div class='l_main'>
        <article id="post-ASP.NET-MVC-视图"
	class="post white-box article-type-post"
	itemscope itemprop="blogPost">
<section class='meta'>
 <h2 class="title">
		 <a href="/2018/02/13/ASP.NET-MVC-视图/">
				 ASP.NET MVC 视图
		 </a>
 </h2>
 <time>
		 Feb 13, 2018
 </time>
 
    
    <div class='cats'>
        <a href="/categories/ASP-NET-MVC/">ASP.NET MVC</a>
    </div>

 <span id="busuanzi_container_page_pv">
		 
		<a href="javascript:void(0)" class="read_cats">本文总阅读量:<span id="busuanzi_value_page_pv"></span>
		</a>
 </span>
</section>

<section class="toc-wrapper"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#视图引擎的结构与性能"><span class="toc-number">1.</span> <span class="toc-text">视图引擎的结构与性能</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#视图引擎机制"><span class="toc-number">1.1.</span> <span class="toc-text">视图引擎机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#视图引擎类（检测已注册的试图引擎）"><span class="toc-number">1.1.1.</span> <span class="toc-text">视图引擎类（检测已注册的试图引擎）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#解析视图引擎"><span class="toc-number">1.1.2.</span> <span class="toc-text">解析视图引擎</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#视图引擎调用者是谁"><span class="toc-number">1.1.3.</span> <span class="toc-text">视图引擎调用者是谁</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#视图对象View"><span class="toc-number">1.1.4.</span> <span class="toc-text">视图对象View</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#视图模板定义"><span class="toc-number">1.2.</span> <span class="toc-text">视图模板定义</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#模板解析"><span class="toc-number">1.2.1.</span> <span class="toc-text">模板解析</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#默认规则和文件夹"><span class="toc-number">1.2.2.</span> <span class="toc-text">默认规则和文件夹</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#用于视图的模板"><span class="toc-number">1.2.3.</span> <span class="toc-text">用于视图的模板</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#母版视图"><span class="toc-number">1.2.4.</span> <span class="toc-text">母版视图</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#HTML帮助器"><span class="toc-number">2.</span> <span class="toc-text">HTML帮助器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#基础帮助器"><span class="toc-number">2.1.</span> <span class="toc-text">基础帮助器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#呈现HTML表单"><span class="toc-number">2.1.1.</span> <span class="toc-text">呈现HTML表单</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#呈现输入元素"><span class="toc-number">2.1.2.</span> <span class="toc-text">呈现输入元素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#操作链接"><span class="toc-number">2.1.3.</span> <span class="toc-text">操作链接</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#部分视图"><span class="toc-number">2.1.4.</span> <span class="toc-text">部分视图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#HtmlHelper其他的原生方法"><span class="toc-number">2.1.5.</span> <span class="toc-text">HtmlHelper其他的原生方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#模板化帮助器"><span class="toc-number">2.2.</span> <span class="toc-text">模板化帮助器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#Display帮助器"><span class="toc-number">2.2.1.</span> <span class="toc-text">Display帮助器</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Editor帮助器"><span class="toc-number">2.2.2.</span> <span class="toc-text">Editor帮助器</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#自定义帮助器"><span class="toc-number">2.3.</span> <span class="toc-text">自定义帮助器</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#帮助器结构"><span class="toc-number">2.3.1.</span> <span class="toc-text">帮助器结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#MvcHtmlString不只是字符串"><span class="toc-number">2.3.2.</span> <span class="toc-text">MvcHtmlString不只是字符串</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#自定义帮助器样例"><span class="toc-number">2.3.3.</span> <span class="toc-text">自定义帮助器样例</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Razor视图引擎"><span class="toc-number">3.</span> <span class="toc-text">Razor视图引擎</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#视图引擎内部机制"><span class="toc-number">3.1.</span> <span class="toc-text">视图引擎内部机制</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#搜索位置"><span class="toc-number">3.1.1.</span> <span class="toc-text">搜索位置</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#代码碎块"><span class="toc-number">3.1.2.</span> <span class="toc-text">代码碎块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#条件式代码碎块"><span class="toc-number">3.1.3.</span> <span class="toc-text">条件式代码碎块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Razor视图对象"><span class="toc-number">3.1.4.</span> <span class="toc-text">Razor视图对象</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#设计一个样例视图"><span class="toc-number">3.2.</span> <span class="toc-text">设计一个样例视图</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#建立视图专用的Model"><span class="toc-number">3.2.1.</span> <span class="toc-text">建立视图专用的Model</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#定义母版视图"><span class="toc-number">3.2.2.</span> <span class="toc-text">定义母版视图</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#定义节"><span class="toc-number">3.2.3.</span> <span class="toc-text">定义节</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#节的默认内容"><span class="toc-number">3.2.4.</span> <span class="toc-text">节的默认内容</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#嵌套布局"><span class="toc-number">3.2.5.</span> <span class="toc-text">嵌套布局</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#声明式Html帮助器"><span class="toc-number">3.2.6.</span> <span class="toc-text">声明式Html帮助器</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#视图编码"><span class="toc-number">4.</span> <span class="toc-text">视图编码</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#视图建模"><span class="toc-number">4.1.</span> <span class="toc-text">视图建模</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#ViewData，ViewBag"><span class="toc-number">4.1.1.</span> <span class="toc-text">ViewData，ViewBag</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#强类型视图模型"><span class="toc-number">4.1.2.</span> <span class="toc-text">强类型视图模型</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#高级功能"><span class="toc-number">4.2.</span> <span class="toc-text">高级功能</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#更改视图引擎检索格式"><span class="toc-number">4.2.1.</span> <span class="toc-text">更改视图引擎检索格式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#呈现操作"><span class="toc-number">4.2.2.</span> <span class="toc-text">呈现操作</span></a></li></ol></li></ol></li></ol></section>

<section class="article typo">
 <div class="article-entry" itemprop="articleBody">
		 <p> 设计并非外观怎样，感觉如何。设计是（解决）如何工作的问题  –<em>Steve Jobs</em></p>
<h2 id="视图引擎的结构与性能"><a href="#视图引擎的结构与性能" class="headerlink" title="视图引擎的结构与性能"></a>视图引擎的结构与性能</h2><p>视图引擎是位浏览器生成html输出的组件</p>
<p>控制器—数据—&gt;视图模板—–&gt;html</p>
<h3 id="视图引擎机制"><a href="#视图引擎机制" class="headerlink" title="视图引擎机制"></a>视图引擎机制</h3><p>在asp.net mvc中，视图引擎只是一个实现固定接口（<code>IViewEngine</code>）的类。<a id="more"></a></p>
<p>每个应用程序可以有一个或多个视图引擎。asp.net mvc5中默认两个Razor，Aspx</p>
<h4 id="视图引擎类（检测已注册的试图引擎）"><a href="#视图引擎类（检测已注册的试图引擎）" class="headerlink" title="视图引擎类（检测已注册的试图引擎）"></a>视图引擎类（检测已注册的试图引擎）</h4><p><code>ViewEngines</code>类跟踪当前已安装的引擎的系统资源库</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">System.Web.Mvc</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>表示对应用程序可用的视图引擎的集合。<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">ViewEngines</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">readonly</span> ViewEngineCollection _engines;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>获取视图引擎。<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>视图引擎。<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> ViewEngineCollection Engines</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">get</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">return</span> ViewEngines._engines;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="title">ViewEngines</span>(<span class="params"></span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      ViewEngineCollection engineCollection = <span class="keyword">new</span> ViewEngineCollection();</span><br><span class="line">      engineCollection.Add((IViewEngine) <span class="keyword">new</span> WebFormViewEngine());</span><br><span class="line">      engineCollection.Add((IViewEngine) <span class="keyword">new</span> RazorViewEngine());</span><br><span class="line">      ViewEngines._engines = engineCollection;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>引擎集合<code>_engines</code>中初始化两个默认视图引擎</p>
<h4 id="解析视图引擎"><a href="#解析视图引擎" class="headerlink" title="解析视图引擎"></a>解析视图引擎</h4><p>视图引擎是实现<code>IViewEngine</code>接口的类，引擎会以架构的名义检索视图对象（实际响应的所需所有信息的容器）</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>定义视图引擎所需的方法。<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IViewEngine</span></span><br><span class="line">  &#123;</span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>使用指定的控制器上下文来查找指定的部分视图。<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>部分视图。<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="controllerContext"&gt;</span>控制器上下文。<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="partialViewName"&gt;</span>部分视图的名称。<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="useCache"&gt;</span>若指定视图引擎返回缓存的视图（如果存在缓存的视图），则为 true；否则为 false。<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function">ViewEngineResult <span class="title">FindPartialView</span>(<span class="params">ControllerContext controllerContext, <span class="keyword">string</span> partialViewName, <span class="keyword">bool</span> useCache</span>)</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>使用指定的控制器上下文来查找指定的视图。<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>页视图。<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="controllerContext"&gt;</span>控制器上下文。<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="viewName"&gt;</span>视图的名称。<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="masterName"&gt;</span>母版的名称。<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="useCache"&gt;</span>若指定视图引擎返回缓存的视图（如果存在缓存的视图），则为 true；否则为 false。<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function">ViewEngineResult <span class="title">FindView</span>(<span class="params">ControllerContext controllerContext, <span class="keyword">string</span> viewName, <span class="keyword">string</span> masterName, <span class="keyword">bool</span> useCache</span>)</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>使用指定的控制器上下文来释放指定的视图。<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="controllerContext"&gt;</span>控制器上下文。<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;param name="view"&gt;</span>视图。<span class="doctag">&lt;/param&gt;</span></span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">ReleaseView</span>(<span class="params">ControllerContext controllerContext, IView view</span>)</span>;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<p>视图引擎<code>findview</code>返回的<code>ViewEngineResult</code>包含三个元素：视图对象，对应的视图引擎，视图模板位置列表</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">ViewEngineResult</span></span><br><span class="line">  &#123;</span><br><span class="line">    。。。</span><br><span class="line"> </span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>获取或设置搜索的位置。<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>搜索的位置。<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> IEnumerable&lt;<span class="keyword">string</span>&gt; SearchedLocations &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>获取或设置视图。<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>视图。<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> IView View &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;summary&gt;</span>获取或设置视图引擎。<span class="doctag">&lt;/summary&gt;</span></span></span><br><span class="line">    <span class="comment"><span class="doctag">///</span> <span class="doctag">&lt;returns&gt;</span>视图引擎。<span class="doctag">&lt;/returns&gt;</span></span></span><br><span class="line">    <span class="keyword">public</span> IViewEngine ViewEngine &#123; <span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>; &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h4 id="视图引擎调用者是谁"><a href="#视图引擎调用者是谁" class="headerlink" title="视图引擎调用者是谁"></a>视图引擎调用者是谁</h4><p>controller与viewengine一起工作明显是由mvc框架实现的，更细一步，控制器和视图引擎的活动是由一个外部管理器对象（操作调用程序）进行协调的。</p>
<p>操作调用程序由负责处理HTTP处理程序直接触发。</p>
<p>操作调用程序主要做两件事：1. 执行控制器的方法并保存操作结果 2. 处理操作结果。</p>
<p><img src="https://luox78.github.io/images/操作调用程序时序图.png" alt="https://luox78.github.io/images/操作调用程序时序图.png"></p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ViewResult:ViewResultBase</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">ViewResult</span>(<span class="params"></span>)</span>;</span><br><span class="line"><span class="keyword">public</span> <span class="keyword">string</span> MasterName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> ViewEngineResult <span class="title">FindView</span>(<span class="params">ControllerContext context</span>)</span>;</span><br><span class="line"></span><br><span class="line">ViewResultBase:ActionResult</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> ViewEngineResult <span class="title">FindView</span>(<span class="params">ControllerContext context</span>)</span>;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">ExecuteResult</span>(<span class="params">ControllerContext context</span>)</span>;</span><br></pre></td></tr></table></figure>
<p>操作调用程序调用ExecuteResult</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">override</span> void ExecuteResult(ControllerContext context)</span><br><span class="line">&#123;</span><br><span class="line">    。。。</span><br><span class="line">    ViewEngineResult result = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span>.View == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        result = <span class="keyword">this</span>.FindView(context);</span><br><span class="line">        <span class="keyword">this</span>.View = result.View;</span><br><span class="line">    &#125;</span><br><span class="line">    。。。</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>ExecuteResult</code>会调用<code>FindView</code></p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">protected</span> <span class="keyword">override</span> ViewEngineResult <span class="title">FindView</span>(<span class="params">ControllerContext context</span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ViewEngineResult result = <span class="keyword">base</span>.ViewEngineCollection.FindView(context, <span class="keyword">base</span>.ViewName, <span class="keyword">this</span>.MasterName);   <span class="keyword">if</span> (result.View != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    StringBuilder builder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    <span class="keyword">foreach</span> (<span class="keyword">string</span> str <span class="keyword">in</span> result.SearchedLocations)</span><br><span class="line">    &#123;</span><br><span class="line">        builder.AppendLine();</span><br><span class="line">        builder.Append(str);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">throw</span> <span class="keyword">new</span> InvalidOperationException(<span class="keyword">string</span>.Format(CultureInfo.CurrentCulture, MvcResources.Common_ViewNotFound, <span class="keyword">new</span> <span class="keyword">object</span>[] &#123; <span class="keyword">base</span>.ViewName, builder &#125;));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>FindView</code>此时会调用<code>ViewEngine</code>里面的方法，遍历模板列表，没有抛出包含所有列表的信息的异常</p>
<p><code>ExecuteResult</code>调用完<code>FindView</code>，执行<code>this.View.Render(viewContext, output);</code>将结果输出到响应流，这里<code>viewContext</code>中= <code>new ViewContext(context, this.View, this.ViewData, this.TempData, output);</code>包含了传入view里面的<code>viewdata</code>，同时强类型模型也是通过<code>viewdata</code>传入的</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> TModel Model</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="keyword">get</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.ViewData.Model;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight verilog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">public override <span class="keyword">void</span> ExecuteResult(ControllerContext <span class="keyword">context</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//判断</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">context</span> == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        throw <span class="keyword">new</span> ArgumentNullException(<span class="string">"context"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">string</span><span class="variable">.IsNullOrEmpty</span>(<span class="keyword">this</span><span class="variable">.ViewName</span>))</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">this</span><span class="variable">.ViewName</span> = <span class="keyword">context</span><span class="variable">.RouteData</span><span class="variable">.GetRequiredString</span>(<span class="string">"action"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//找视图</span></span><br><span class="line">    ViewEngineResult result = <span class="literal">null</span>;</span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">this</span><span class="variable">.View</span> == <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        result = <span class="keyword">this</span><span class="variable">.FindView</span>(<span class="keyword">context</span>);</span><br><span class="line">        <span class="keyword">this</span><span class="variable">.View</span> = result<span class="variable">.View</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//输出</span></span><br><span class="line">    TextWriter <span class="keyword">output</span> = <span class="keyword">context</span><span class="variable">.HttpContext</span><span class="variable">.Response</span><span class="variable">.Output</span>;</span><br><span class="line">    ViewContext viewContext = <span class="keyword">new</span> ViewContext(<span class="keyword">context</span>, <span class="keyword">this</span><span class="variable">.View</span>, <span class="keyword">this</span><span class="variable">.ViewData</span>, <span class="keyword">this</span><span class="variable">.TempData</span>, <span class="keyword">output</span>);</span><br><span class="line">    <span class="keyword">this</span><span class="variable">.View</span><span class="variable">.Render</span>(viewContext, <span class="keyword">output</span>);</span><br><span class="line">    <span class="keyword">if</span> (result != <span class="literal">null</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        result<span class="variable">.ViewEngine</span><span class="variable">.ReleaseView</span>(<span class="keyword">context</span>, <span class="keyword">this</span><span class="variable">.View</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="视图对象View"><a href="#视图对象View" class="headerlink" title="视图对象View"></a>视图对象View</h4><p><code>public IView View { get; [CompilerGenerated] private set; }</code></p>
<p>视图对象是实现IView接口的实例，视图对象的唯一目的是编写一些HTML响应到文本编辑器</p>
<h3 id="视图模板定义"><a href="#视图模板定义" class="headerlink" title="视图模板定义"></a>视图模板定义</h3><h4 id="模板解析"><a href="#模板解析" class="headerlink" title="模板解析"></a>模板解析</h4><p>在任务处理结束时，控制器要找出呈现给用户的下一个视图的名称。但视图名称转换成对应的HTML还需要一些额外的步骤</p>
<p>1。确定使用哪个视图引擎可以成功处理该视图的请求 2。视图名称必须匹配到一个html布局，并基于该布局创建一个试图对象 3。从获取视图名称开始，ViewResult对象就会按照视图引擎出现在ViewEngines.Engines集合中顺序，对所有已经安装的视图引擎进行插叙</p>
<h4 id="默认规则和文件夹"><a href="#默认规则和文件夹" class="headerlink" title="默认规则和文件夹"></a>默认规则和文件夹</h4><p>默认情况下系统会在View文件夹下找，controller名对应的文件夹下action对应的后缀为cshtml、vbhtml的文件（Razor）</p>
<h4 id="用于视图的模板"><a href="#用于视图的模板" class="headerlink" title="用于视图的模板"></a>用于视图的模板</h4><p>aspx视图引擎与webform中aspx页面语法基本一致，最大的不同在于，mvc中aspx并不是公共资源，不通i过特殊设置不能直接访问，所有的请求都是有controller接受和回复，对应的aspx页面只不过是回复的模板</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ActionResult About()</span><br><span class="line">&#123;</span><br><span class="line">    ViewBag.Message = <span class="string">"Your application description page."</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">return</span> <span class="title">View</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>About.cshtml，这里通过viewbag传递的值</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@&#123;</span></span><br><span class="line">    ViewBag.Title = <span class="string">"About"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">&lt;h2&gt;</span><span class="meta">@ViewBag.Title.&lt;/h2&gt;</span></span><br><span class="line"><span class="variable">&lt;h3&gt;</span><span class="meta">@ViewBag.Message&lt;/h3&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="variable">&lt;p&gt;</span>Use this area to provide additional information.<span class="variable">&lt;/p&gt;</span></span><br></pre></td></tr></table></figure>
<h4 id="母版视图"><a href="#母版视图" class="headerlink" title="母版视图"></a>母版视图</h4><ol>
<li><p>在 cshtml中直接指定</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@&#123;</span><br><span class="line">    Layout = <span class="string">"Index.cshtml"</span><span class="comment">;</span></span><br><span class="line">    ViewBag.Title = <span class="string">"About"</span><span class="comment">;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>默认的layout在<code>_ViewStart.cshtml</code>中指定</p>
</li>
</ol>
<h2 id="HTML帮助器"><a href="#HTML帮助器" class="headerlink" title="HTML帮助器"></a>HTML帮助器</h2><p>asp.net mvc中创建html视图使用的不是webform中的空间而是HTML帮助器。</p>
<p>HTML帮助器就是一个简单的HTML工厂，返回的是没mvchtmlstring，内部实现也是使用stringbuilder进行拼接，视图引擎解析</p>
<h3 id="基础帮助器"><a href="#基础帮助器" class="headerlink" title="基础帮助器"></a>基础帮助器</h3><p><code>BeginForm,BeginRouteForm</code></p>
<p><code>EndForm</code></p>
<p><code>CheckBox,CheckBoxFor</code></p>
<p><code>Hidden,HiddenFor</code></p>
<p><code>Password,PasswordFor</code>….</p>
<p>用法是<code>@Html.ActionLink(...)</code></p>
<p><code>BeginForm,BeginRouteForm</code>区别是带Route可以导航到任何已注册路由的任何位置，BeginForm只能使用控制器，action等属性</p>
<p><code>CheckBox,CheckBoxFor</code>区别：带For参数只接受lamada表达式</p>
<p>注意：HTML帮助器是视图引擎的内置属性，所以不同的视图引擎帮助器是不同的，尽管默认的两个细节都是差不多的，但内部还是有些不同的</p>
<p>下面举一些例子</p>
<h4 id="呈现HTML表单"><a href="#呈现HTML表单" class="headerlink" title="呈现HTML表单"></a>呈现HTML表单</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">using</span> (Html.BeginForm(<span class="string">"Index"</span>, <span class="string">"Home"</span>))</span><br><span class="line">&#123;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>BeginForm代表《form》，using中finally会添加《/form》，BeginForm当然还有很多重载</p>
<h4 id="呈现输入元素"><a href="#呈现输入元素" class="headerlink" title="呈现输入元素"></a>呈现输入元素</h4><p>再次说明，从功能的角度使用帮助器和直接编写HTML是一样的效果，下面的事例是复选框选中同时禁用</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Html</span>.CheckBox(<span class="string">"wode"</span>, <span class="literal">true</span>, <span class="string">htmlAttributes:</span> <span class="keyword">new</span> &#123; disabled = <span class="string">"disabled"</span> &#125;)</span><br></pre></td></tr></table></figure>
<h4 id="操作链接"><a href="#操作链接" class="headerlink" title="操作链接"></a>操作链接</h4><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">Html</span>.<span class="keyword">ActionLink</span>("<span class="keyword">index</span>","<span class="keyword">Index</span>")</span><br></pre></td></tr></table></figure>
<p>对应的html</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"/"</span>&gt;</span>index<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>RouteLink帮助器的工作方式差不多相同，可以使用任何已经注册的路由名称来确定生成的URL模式</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Html</span>.RouteLink(<span class="string">"index"</span>, <span class="string">"Default"</span>, <span class="keyword">new</span> &#123; Controller = <span class="string">"Home"</span>, Action = <span class="string">"Index"</span> &#125;)</span><br></pre></td></tr></table></figure>
<p>如果想在a标签下嵌套其他标签，这时候可以使用UrlHelper来解决</p>
<figure class="highlight livecodeserver"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">a</span> href=<span class="string">"@Url.Action("</span>Index<span class="string">")"</span>&gt;</span><br><span class="line">   <span class="comment"> //添加其他标签</span></span><br><span class="line">&lt;/<span class="keyword">a</span>&gt;</span><br></pre></td></tr></table></figure>
<h4 id="部分视图"><a href="#部分视图" class="headerlink" title="部分视图"></a>部分视图</h4><p>可以使用Partial和RenderPartial帮助器插入部分视图看。区别是，Partial返回的是字符串，RenderPartial会写入输出流，返回空，所以两者的用法略有不同</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">Html</span>.<span class="keyword">Partial</span>("<span class="keyword">_PartialForTest</span>")</span><br><span class="line">@&#123; <span class="selector-tag">Html</span><span class="selector-class">.RenderPartial</span>("_<span class="selector-tag">PartialForTest</span>");&#125;</span><br></pre></td></tr></table></figure>
<h4 id="HtmlHelper其他的原生方法"><a href="#HtmlHelper其他的原生方法" class="headerlink" title="HtmlHelper其他的原生方法"></a>HtmlHelper其他的原生方法</h4><ul>
<li><code>AntiForgeryToken</code>：创建一个包含口令的隐藏域，Post、Get到controller时添加[ValidateAntiForgeryToken]特性验证</li>
<li><code>Raw</code>：返回未经编码的原始Html字符串</li>
<li><code>AttributeEncode</code>：这个方法在效率上比HtmlEncode快很多。但这是有代价的付出的HtmlAttributeEncode只对 左引号（<strong>“</strong>），左括号（<strong>（</strong>），and符合（&amp;）转换为等效的字符实体。</li>
</ul>
<p><em>“*<em>HtmlAttributeEncode<strong> 方法的结果字符串只应当用于由双引号括起的属性。使用 </strong>HtmlAttributeEncode*</em> 方法和用单引号括起的属性可能会引起安全问题。”</em></p>
<p>看大家的选择了，如果仅仅是担心输出HTML代码和JS方面的安全，可以使用<strong>HtmlAttributeEncode</strong> 方法，效率更高！</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@Html.AttributeEncode(<span class="string">"&lt;script&gt;alert(\"nihao\")&lt;/script&gt;"</span>)</span><br><span class="line"><span class="symbol">html:</span><span class="variable">&amp;lt</span>;script&gt;alert(<span class="variable">&amp;quot</span>;nihao<span class="variable">&amp;quot</span>;)<span class="variable">&amp;lt</span>;/script&gt;</span><br></pre></td></tr></table></figure>
<h3 id="模板化帮助器"><a href="#模板化帮助器" class="headerlink" title="模板化帮助器"></a>模板化帮助器</h3><p>一遍遍编写Html模板枯燥且容易出错，模板化帮助器可以很好的解决这一问题</p>
<p>在asp.net mvc中Editor，Display是两个基本的模板化帮助器</p>
<h4 id="Display帮助器"><a href="#Display帮助器" class="headerlink" title="Display帮助器"></a>Display帮助器</h4><p>显示viewdata里面的值</p>
<figure class="highlight julia"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">@&#123;</span><br><span class="line">    ViewData[<span class="string">"Title"</span>] = <span class="string">"nihao"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Html</span>.<span class="built_in">Display</span>(<span class="string">"Title"</span>)</span><br></pre></td></tr></table></figure>
<p>显示model对应属性的值</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">Html</span>.<span class="keyword">DisplayFor</span>(<span class="keyword">model</span> =&gt; model.Title)</span><br></pre></td></tr></table></figure>
<p>显示model中所有的值</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">Html</span>.<span class="keyword">DisplayForModel</span>()</span><br></pre></td></tr></table></figure>
<h4 id="Editor帮助器"><a href="#Editor帮助器" class="headerlink" title="Editor帮助器"></a>Editor帮助器</h4><p>Editor帮助器让你可以编辑指定的值</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">Html</span>.<span class="keyword">EditorFor</span>(<span class="keyword">model</span> =&gt; model.Title)</span><br></pre></td></tr></table></figure>
<p>模板化帮助器可以使用模板进行自定义编辑，比如对于Editor可以将模板文件放在对应的controller下面的EditorTemplates下或者公用的Views/Shared下</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">Html</span>.<span class="keyword">EditorFor</span>(<span class="keyword">model</span> =&gt; model.date,<span class="string">"DateTime"</span>)</span><br></pre></td></tr></table></figure>
<p>视图引擎会自己找对应文件夹下面的文件</p>
<h3 id="自定义帮助器"><a href="#自定义帮助器" class="headerlink" title="自定义帮助器"></a>自定义帮助器</h3><p>有时候mvc提供的帮助器下没有我们需要的，这时候可以编辑自定义帮助器</p>
<h4 id="帮助器结构"><a href="#帮助器结构" class="headerlink" title="帮助器结构"></a>帮助器结构</h4><p>htmlhelper就是一个普通拓展方法</p>
<h4 id="MvcHtmlString不只是字符串"><a href="#MvcHtmlString不只是字符串" class="headerlink" title="MvcHtmlString不只是字符串"></a>MvcHtmlString不只是字符串</h4><p>自定义帮助器返回对象最好是MvcHtmlString封装对象而不是普通的字符串，实际上，所有的原生的帮助器方法也都是通过stringbuilder然后构造的MvcHtmlString对象，可以通过以下代码轻松的创建MvcHtmlString对象</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">MvcHtmlString.<span class="keyword">Create</span>((<span class="keyword">string</span>)str);</span><br></pre></td></tr></table></figure>
<h4 id="自定义帮助器样例"><a href="#自定义帮助器样例" class="headerlink" title="自定义帮助器样例"></a>自定义帮助器样例</h4><p>添加引用并使用</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">@using</span> _02.Helper</span><br><span class="line"></span><br><span class="line"><span class="variable">@Html</span>.Title(<span class="string">"自定义帮助器创建的title"</span>)</span><br></pre></td></tr></table></figure>
<p>简单的拓展方法</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">TitleHelper</span></span><br><span class="line">  &#123;</span><br><span class="line">      <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MvcHtmlString <span class="title">Title</span>(<span class="params"><span class="keyword">this</span> HtmlHelper html, <span class="keyword">string</span> title, <span class="keyword">string</span> className</span>)</span></span><br><span class="line"><span class="function">      </span>&#123;</span><br><span class="line">          <span class="keyword">var</span> h1Tag = <span class="keyword">new</span> TagBuilder(<span class="string">"h1"</span>);</span><br><span class="line">          <span class="keyword">if</span> (!<span class="keyword">string</span>.IsNullOrEmpty(className))</span><br><span class="line">          &#123;</span><br><span class="line">              h1Tag.Attributes[<span class="string">"class"</span>] = className;</span><br><span class="line">          &#125;</span><br><span class="line">          h1Tag.SetInnerText(title);</span><br><span class="line">          <span class="keyword">return</span> MvcHtmlString.Create(h1Tag.ToString());</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>
<h2 id="Razor视图引擎"><a href="#Razor视图引擎" class="headerlink" title="Razor视图引擎"></a>Razor视图引擎</h2><h3 id="视图引擎内部机制"><a href="#视图引擎内部机制" class="headerlink" title="视图引擎内部机制"></a>视图引擎内部机制</h3><h4 id="搜索位置"><a href="#搜索位置" class="headerlink" title="搜索位置"></a>搜索位置</h4><p>视图引擎的构造函数中定义了视图搜索位置的格式</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">RazorViewEngine</span>(<span class="params">IViewPageActivator viewPageActivator</span>)</span></span><br><span class="line"><span class="function">      : <span class="title">base</span>(<span class="params">viewPageActivator</span>)</span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">      <span class="keyword">this</span>.AreaViewLocationFormats = <span class="keyword">new</span> <span class="keyword">string</span>[<span class="number">4</span>]</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"~/Areas/&#123;2&#125;/Views/&#123;1&#125;/&#123;0&#125;.cshtml"</span>,</span><br><span class="line">        <span class="string">"~/Areas/&#123;2&#125;/Views/&#123;1&#125;/&#123;0&#125;.vbhtml"</span>,</span><br><span class="line">        <span class="string">"~/Areas/&#123;2&#125;/Views/Shared/&#123;0&#125;.cshtml"</span>,</span><br><span class="line">        <span class="string">"~/Areas/&#123;2&#125;/Views/Shared/&#123;0&#125;.vbhtml"</span></span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">this</span>.AreaMasterLocationFormats = <span class="keyword">new</span> <span class="keyword">string</span>[<span class="number">4</span>]</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"~/Areas/&#123;2&#125;/Views/&#123;1&#125;/&#123;0&#125;.cshtml"</span>,</span><br><span class="line">        <span class="string">"~/Areas/&#123;2&#125;/Views/&#123;1&#125;/&#123;0&#125;.vbhtml"</span>,</span><br><span class="line">        <span class="string">"~/Areas/&#123;2&#125;/Views/Shared/&#123;0&#125;.cshtml"</span>,</span><br><span class="line">        <span class="string">"~/Areas/&#123;2&#125;/Views/Shared/&#123;0&#125;.vbhtml"</span></span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">this</span>.AreaPartialViewLocationFormats = <span class="keyword">new</span> <span class="keyword">string</span>[<span class="number">4</span>]</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"~/Areas/&#123;2&#125;/Views/&#123;1&#125;/&#123;0&#125;.cshtml"</span>,</span><br><span class="line">        <span class="string">"~/Areas/&#123;2&#125;/Views/&#123;1&#125;/&#123;0&#125;.vbhtml"</span>,</span><br><span class="line">        <span class="string">"~/Areas/&#123;2&#125;/Views/Shared/&#123;0&#125;.cshtml"</span>,</span><br><span class="line">        <span class="string">"~/Areas/&#123;2&#125;/Views/Shared/&#123;0&#125;.vbhtml"</span></span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">this</span>.ViewLocationFormats = <span class="keyword">new</span> <span class="keyword">string</span>[<span class="number">4</span>]</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"~/Views/&#123;1&#125;/&#123;0&#125;.cshtml"</span>,</span><br><span class="line">        <span class="string">"~/Views/&#123;1&#125;/&#123;0&#125;.vbhtml"</span>,</span><br><span class="line">        <span class="string">"~/Views/Shared/&#123;0&#125;.cshtml"</span>,</span><br><span class="line">        <span class="string">"~/Views/Shared/&#123;0&#125;.vbhtml"</span></span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">this</span>.MasterLocationFormats = <span class="keyword">new</span> <span class="keyword">string</span>[<span class="number">4</span>]</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"~/Views/&#123;1&#125;/&#123;0&#125;.cshtml"</span>,</span><br><span class="line">        <span class="string">"~/Views/&#123;1&#125;/&#123;0&#125;.vbhtml"</span>,</span><br><span class="line">        <span class="string">"~/Views/Shared/&#123;0&#125;.cshtml"</span>,</span><br><span class="line">        <span class="string">"~/Views/Shared/&#123;0&#125;.vbhtml"</span></span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">this</span>.PartialViewLocationFormats = <span class="keyword">new</span> <span class="keyword">string</span>[<span class="number">4</span>]</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"~/Views/&#123;1&#125;/&#123;0&#125;.cshtml"</span>,</span><br><span class="line">        <span class="string">"~/Views/&#123;1&#125;/&#123;0&#125;.vbhtml"</span>,</span><br><span class="line">        <span class="string">"~/Views/Shared/&#123;0&#125;.cshtml"</span>,</span><br><span class="line">        <span class="string">"~/Views/Shared/&#123;0&#125;.vbhtml"</span></span><br><span class="line">      &#125;;</span><br><span class="line">      <span class="keyword">this</span>.FileExtensions = <span class="keyword">new</span> <span class="keyword">string</span>[<span class="number">2</span>]</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">"cshtml"</span>,</span><br><span class="line">        <span class="string">"vbhtml"</span></span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<h4 id="代码碎块"><a href="#代码碎块" class="headerlink" title="代码碎块"></a>代码碎块</h4><figure class="highlight dust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml">@</span><span class="template-tag">&#123;//<span class="name">code</span>&#125;</span><span class="xml"></span></span><br></pre></td></tr></table></figure>
<p>解析器会正确的识别标记 <code>@{&lt;h1&gt;@Viewbag.Title&lt;/h1&gt;}</code></p>
<p>可以通过@（）插入字符</p>
<figure class="highlight dts"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="params">&lt;p&gt;</span>@(<span class="string">"hello"</span> + Model.userName)<span class="params">&lt;/p&gt;</span></span><br></pre></td></tr></table></figure>
<p>括号中同时可以 放置一个函数</p>
<figure class="highlight oxygene"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;p&gt;@(<span class="function"><span class="keyword">Method</span><span class="params">()</span>)&lt;/<span class="title">p</span>&gt;</span></span><br><span class="line"><span class="function">//等同于&lt;<span class="title">p</span>&gt;@<span class="comment">&#123;Method()；&#125;</span>&lt;/<span class="title">p</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>注释使用@<em>。。。</em>@，使用@@表示@字符</p>
<p>Razor处理过的视图都是自动编码的，如果想保留原始格式使用</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">Html</span>.<span class="keyword">Raw</span>(...)</span><br></pre></td></tr></table></figure>
<h4 id="条件式代码碎块"><a href="#条件式代码碎块" class="headerlink" title="条件式代码碎块"></a>条件式代码碎块</h4><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">div</span> <span class="built_in">class</span>=<span class="string">"@Model.Css"</span>&gt;</span><br><span class="line">	....</span><br><span class="line">&lt;/<span class="keyword">div</span>&gt;</span><br></pre></td></tr></table></figure>
<p>当Model.Css为null时，解析器理论上会抛出异常，但mvc4之后，条件逻辑已经内置在Razor引擎中了</p>
<h4 id="Razor视图对象"><a href="#Razor视图对象" class="headerlink" title="Razor视图对象"></a>Razor视图对象</h4><p>Razor引擎生成视图对象可以通过反射dll看到继承自WebViewPage</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public <span class="class"><span class="keyword">class</span> <span class="title">_Page_Views_Home_About_cshtml</span> : <span class="title">WebViewPage</span>&lt;object&gt;</span></span><br></pre></td></tr></table></figure>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br></pre></td><td class="code"><pre><span class="line">namespace System.Web.Mvc</span><br><span class="line">&#123;</span><br><span class="line">    using System;</span><br><span class="line">    using System.Globalization;</span><br><span class="line">    using System.IO;</span><br><span class="line">    using System.Runtime.CompilerServices;</span><br><span class="line">    using System.Web;</span><br><span class="line">    using System.Web.Mvc.Properties;</span><br><span class="line">    using System.Web.WebPages;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">WebViewPage</span> : <span class="type">WebPageBase</span>, <span class="type">IViewDataContainer</span>, <span class="type">IViewStartPageChild</span></span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> AjaxHelper&lt;<span class="keyword">object</span>&gt; _ajax;</span><br><span class="line">        <span class="keyword">private</span> HttpContextBase _context;</span><br><span class="line">        <span class="keyword">private</span> DynamicViewDataDictionary _dynamicViewData;</span><br><span class="line">        <span class="keyword">private</span> HtmlHelper&lt;<span class="keyword">object</span>&gt; _html;</span><br><span class="line">        <span class="keyword">private</span> ViewDataDictionary _viewData;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">protected</span> WebViewPage()</span><br><span class="line">        &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">protected</span> <span class="keyword">override</span> void ConfigurePage(WebPageBase parentPage)</span><br><span class="line">        &#123;</span><br><span class="line">            WebViewPage page = parentPage <span class="keyword">as</span> WebViewPage;</span><br><span class="line">            <span class="keyword">if</span> (page == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">throw</span> new InvalidOperationException(string.Format(CultureInfo.CurrentCulture, MvcResources.CshtmlView_WrongViewBase, new <span class="keyword">object</span>[] &#123; parentPage.get_VirtualPath() &#125;));</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.ViewContext = page.ViewContext;</span><br><span class="line">            <span class="keyword">this</span>.ViewData = page.ViewData;</span><br><span class="line">            <span class="keyword">this</span>.InitHelpers();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">override</span> void ExecutePageHierarchy()</span><br><span class="line">        &#123;</span><br><span class="line">            TextWriter writer = <span class="keyword">this</span>.ViewContext.Writer;</span><br><span class="line">            <span class="keyword">this</span>.ViewContext.Writer = base.get_Output();</span><br><span class="line">            base.ExecutePageHierarchy();</span><br><span class="line">            <span class="keyword">if</span> (!string.IsNullOrEmpty(<span class="keyword">this</span>.OverridenLayoutPath))</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>.set_Layout(<span class="keyword">this</span>.OverridenLayoutPath);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">this</span>.ViewContext.Writer = writer;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> virtual void InitHelpers()</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.Html = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">this</span>.Ajax = <span class="literal">null</span>;</span><br><span class="line">            <span class="keyword">this</span>.Url = new UrlHelper(<span class="keyword">this</span>.ViewContext.RequestContext);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">protected</span> virtual void SetViewData(ViewDataDictionary viewData)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>._viewData = viewData;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> AjaxHelper&lt;<span class="keyword">object</span>&gt; Ajax</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">get</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> ((<span class="keyword">this</span>._ajax == <span class="literal">null</span>) &amp;&amp; (<span class="keyword">this</span>.ViewContext != <span class="literal">null</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">this</span>._ajax = new AjaxHelper&lt;<span class="keyword">object</span>&gt;(<span class="keyword">this</span>.ViewContext, <span class="keyword">this</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>._ajax;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">set</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>._ajax = value;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">override</span> HttpContextBase Context</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">get</span> =&gt; </span><br><span class="line">                (<span class="keyword">this</span>._context ?? <span class="keyword">this</span>.ViewContext.HttpContext);</span><br><span class="line">            <span class="keyword">set</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>._context = value;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> HtmlHelper&lt;<span class="keyword">object</span>&gt; Html</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">get</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> ((<span class="keyword">this</span>._html == <span class="literal">null</span>) &amp;&amp; (<span class="keyword">this</span>.ViewContext != <span class="literal">null</span>))</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">this</span>._html = new HtmlHelper&lt;<span class="keyword">object</span>&gt;(<span class="keyword">this</span>.ViewContext, <span class="keyword">this</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>._html;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">set</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>._html = value;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">object</span> Model =&gt;</span><br><span class="line">            <span class="keyword">this</span>.ViewData.Model;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">internal</span> string OverridenLayoutPath &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> TempDataDictionary TempData =&gt;</span><br><span class="line">            <span class="keyword">this</span>.ViewContext.TempData;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> UrlHelper Url &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        [Dynamic]</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">object</span> ViewBag</span><br><span class="line">        &#123;</span><br><span class="line">            [<span class="keyword">return</span>: Dynamic]</span><br><span class="line">            <span class="keyword">get</span></span><br><span class="line">            &#123;</span><br><span class="line">                Func&lt;ViewDataDictionary&gt; viewDataThunk = <span class="literal">null</span>;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>._dynamicViewData == <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (viewDataThunk == <span class="literal">null</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        viewDataThunk = () =&gt; <span class="keyword">this</span>.ViewData;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">this</span>._dynamicViewData = new DynamicViewDataDictionary(viewDataThunk);</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>._dynamicViewData;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> System.Web.Mvc.ViewContext ViewContext &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> ViewDataDictionary ViewData</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">get</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (<span class="keyword">this</span>._viewData == <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">this</span>.SetViewData(new ViewDataDictionary());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">this</span>._viewData;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">set</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>.SetViewData(value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>可以看到View可以使用的对象都在这里面</p>
<h3 id="设计一个样例视图"><a href="#设计一个样例视图" class="headerlink" title="设计一个样例视图"></a>设计一个样例视图</h3><h4 id="建立视图专用的Model"><a href="#建立视图专用的Model" class="headerlink" title="建立视图专用的Model"></a>建立视图专用的Model</h4><figure class="highlight vala"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">namespace</span> <span class="title">_02</span>.<span class="title">Models</span>.<span class="title">Home</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HomeIndexViewModel</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">string</span> Str &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>在视图中声明model类型</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@model _02<span class="selector-class">.Models</span><span class="selector-class">.Home</span><span class="selector-class">.HomeIndexViewModel</span></span><br></pre></td></tr></table></figure>
<p>使用Model</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">h1</span>&gt;</span>@Model.Str<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>controller中添加返回对象</p>
<figure class="highlight aspectj"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ActionResult Index()</span><br><span class="line">       &#123;</span><br><span class="line">           <span class="keyword">return</span> View(<span class="keyword">new</span> HomeIndexViewModel()</span><br><span class="line">           &#123;</span><br><span class="line">               Str = <span class="string">"传递的数据"</span></span><br><span class="line">           &#125;);</span><br><span class="line">       &#125;</span><br></pre></td></tr></table></figure>
<h4 id="定义母版视图"><a href="#定义母版视图" class="headerlink" title="定义母版视图"></a>定义母版视图</h4><p>布局页就是一个普通的<code>cshtml</code>页面但是必须添加<code>@RenderBody()</code>告诉解析器在哪儿注入布局模板</p>
<p>layout可以使任意路径或设置条件，默认的layout在<code>_VIewStart.cshtml</code>中定义</p>
<figure class="highlight armasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">@&#123;</span></span><br><span class="line">    <span class="meta">if</span> (Request.<span class="keyword">Browser.IsMobileDevice)</span></span><br><span class="line"><span class="keyword"> </span>   &#123;</span><br><span class="line">        Layout = <span class="string">"About.cshtml"</span><span class="comment">;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>通过~返回根目录</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">Layout</span> = <span class="string">"~/Views/Shared/_Layout.cshtml"</span><span class="comment">;</span></span><br></pre></td></tr></table></figure>
<h4 id="定义节"><a href="#定义节" class="headerlink" title="定义节"></a>定义节</h4><p><code>RenderBody</code>方法定义了布局注入的单个点，但你可能需要将内容注入到多个位置，在布局模板中，可以通过在希望出现内容的位置放置一个<code>RenderSection</code>的调用来定义注入点</p>
<p>默认的_Layout中就有关于scripts的节</p>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RenderSection</span>(<span class="string">"scripts"</span>, <span class="string">required:</span> <span class="literal">false</span>)</span><br></pre></td></tr></table></figure>
<p>required: false指的是不是必须的，可以通过@section+名称进行节的编写</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@section scripts</span><br><span class="line">&#123;</span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="actionscript">alert(<span class="string">"nihao"</span>);</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h4 id="节的默认内容"><a href="#节的默认内容" class="headerlink" title="节的默认内容"></a>节的默认内容</h4><p><code>webform</code>中视图引擎中的母版页可以指定默认内容，Razor没有但是可以通过<code>IsSectionDefined</code>进行判断，添加默认的内容</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;<span class="keyword">div</span> <span class="built_in">id</span>=<span class="string">"footer"</span>&gt;</span><br><span class="line">	@<span class="keyword">if</span>(IsSectionDefined(<span class="string">"name"</span>))&#123;</span><br><span class="line">      @RenderSection(<span class="string">"name"</span>);</span><br><span class="line">	&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      &lt;span&gt;undefined&lt;/span&gt;</span><br><span class="line">	&#125;</span><br><span class="line">&lt;/<span class="keyword">div</span>&gt;</span><br></pre></td></tr></table></figure>
<h4 id="嵌套布局"><a href="#嵌套布局" class="headerlink" title="嵌套布局"></a>嵌套布局</h4><p>布局是可以嵌套的通过指定Layout实现嵌套</p>
<h4 id="声明式Html帮助器"><a href="#声明式Html帮助器" class="headerlink" title="声明式Html帮助器"></a>声明式Html帮助器</h4><p>通过<code>HtmlHelper</code>创建网页内容如果有很多元素就十分困难，这时候使用声明式Html帮助器就方便很多</p>
<p>首先在项目中添加App_Code，添加<code>MyHelpers.cshtml</code>，定义一个简单的方法，格式@helper+签名</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">helper</span> ShowTitle(string title)</span><br><span class="line">&#123;</span><br><span class="line">    &lt;<span class="selector-tag">h1</span>&gt;@<span class="keyword">title</span>&lt;/<span class="keyword">h1</span>&gt;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">MyHelpers</span>.<span class="keyword">ShowTitle</span>("<span class="keyword">nihao</span>")</span><br></pre></td></tr></table></figure>
<p>注意在App_Code外编辑的帮助器不会被检测</p>
<h2 id="视图编码"><a href="#视图编码" class="headerlink" title="视图编码"></a>视图编码</h2><h3 id="视图建模"><a href="#视图建模" class="headerlink" title="视图建模"></a>视图建模</h3><h4 id="ViewData，ViewBag"><a href="#ViewData，ViewBag" class="headerlink" title="ViewData，ViewBag"></a><code>ViewData，ViewBag</code></h4><p>通过这两个对象可以从controller中传值到view中，两个类型都是<code>dynomic</code>，用法：</p>
<figure class="highlight gauss"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ViewData[<span class="string">"Title"</span>]=<span class="string">"nihao"</span>;</span><br><span class="line">ViewBag.<span class="built_in">Title</span>=<span class="string">"nihao"</span>;</span><br><span class="line"></span><br><span class="line"><span class="built_in">view</span>中：</span><br><span class="line"><span class="comment">@ViewData["Title"]</span></span><br><span class="line"><span class="comment">@</span>ViewBag.<span class="built_in">Title</span></span><br></pre></td></tr></table></figure>
<h4 id="强类型视图模型"><a href="#强类型视图模型" class="headerlink" title="强类型视图模型"></a>强类型视图模型</h4><p>上面已经说过</p>
<p>应尽量减少<code>viewbag，viewdata</code>，因为使用<code>viewmodel</code>更易维护，同时注意的是这里的model是视图模型，应尽量减少直接将数据模型当做视图模型</p>
<h3 id="高级功能"><a href="#高级功能" class="headerlink" title="高级功能"></a>高级功能</h3><h4 id="更改视图引擎检索格式"><a href="#更改视图引擎检索格式" class="headerlink" title="更改视图引擎检索格式"></a>更改视图引擎检索格式</h4><p>创建自己的检索格式，项目中只是用Razor就没必要检索aspx格式的视图，提高效率，同时可以将<code>PartialViews</code>放在不同的地方便于管理</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> _02.App_Start</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NewFormatViewEngine</span> :</span> RazorViewEngine</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">NewFormatViewEngine</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">this</span>.MasterLocationFormats = base.MasterLocationFormats;</span><br><span class="line">            <span class="keyword">this</span>.ViewLocationFormats = <span class="keyword">new</span> <span class="built_in">string</span>[]</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"~/Views/&#123;1&#125;/&#123;0&#125;.cshtml"</span></span><br><span class="line">            &#125;;</span><br><span class="line">            <span class="keyword">this</span>.PartialViewLocationFormats = <span class="keyword">new</span> <span class="built_in">string</span>[]</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"~/PartialViews/&#123;1&#125;/&#123;0&#125;.cshtml"</span></span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>我在App_Start中创建自己的新类继承自<code>RazorViewEngine</code></p>
<p>在<code>Global.asax</code>中，清空原来的引擎，添加新的</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MvcApplication</span> :</span> System.Web.HttpApplication</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">Application_Start</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">			。。。</span><br><span class="line">            ViewEngines.Engines.Clear();</span><br><span class="line">            ViewEngines.Engines.Add(<span class="keyword">new</span> NewFormatViewEngine());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<p>需要注意的是要添加Web.config配置对应的视图引擎，这里直接复制Views里面的即可</p>
<p>已经可以使用了，文件夹PartialViews ==&gt; Home ==&gt; Home_Contact_PartialView.cshtml</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">Html</span>.<span class="keyword">Partial</span>("<span class="keyword">Home_Contact_PartialView</span>")</span><br></pre></td></tr></table></figure>
<h4 id="呈现操作"><a href="#呈现操作" class="headerlink" title="呈现操作"></a>呈现操作</h4><p>当需要呈现一个固定不变的视图或者需要控制器提供数据的视图的时候使用呈现操作即可</p>
<p>菜单例子：控制中添加返回<code>PartialView</code>的方法Menu</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> ActionResult <span class="title">Menu</span><span class="params">()</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> PartialView(<span class="keyword">new</span> List&lt;<span class="built_in">string</span>&gt;()</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="string">"menu1"</span>,</span><br><span class="line">                <span class="string">"menu2"</span>,</span><br><span class="line">                <span class="string">"menu3"</span></span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>
<p>创建对应的视图</p>
<figure class="highlight gherkin"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@model</span> IList<span class="variable">&lt;string&gt;</span></span><br><span class="line"> </span><br><span class="line"><span class="variable">&lt;div&gt;</span></span><br><span class="line">    <span class="meta">@foreach</span> (var str in Model)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">&lt;a&gt;</span><span class="meta">@str&lt;/a&gt;</span></span><br><span class="line">    &#125;</span><br><span class="line"><span class="variable">&lt;/div&gt;</span></span><br></pre></td></tr></table></figure>
<p>使用</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">@<span class="keyword">Html</span>.<span class="keyword">Action</span>("<span class="keyword">Menu</span>")</span><br></pre></td></tr></table></figure>
<p>与@Html.Partial一样<code>ActionRender</code>也是写入到响应流，Action直接返回html字符串</p>

 </div>
 
 <div class="article-tags tags">
		 
		 <a href="/tags/ASP-NET-MVC5-编程实战/">ASP.NET MVC5 编程实战</a>
		 
 </div>
 
<div id="comments" style="margin: 5px auto;">
	<div id="comment"></div>
                        <script>
                            new Valine({
                        el: '#comment' ,
                        notify:false, 
                        verify:false, 
                        appId: 'oTcHLJ1mpOGAcKcahsaQEBaQ-gzGzoHsz',
                        appKey: 'Jq4QEoyIo2Y40s3PHny873nz',
                        placeholder: ' ( *￣▽￣)((≧︶≦*)',
                        path:window.location.pathname, 
						avatar:'retro'
                    });
                        </script>
</div>
 
 <div class="art-item-footer">
		 
		 <span class="art-item-left">
				 <i class="icon icon-chevron-thin-left"></i>prev：<a href="/2018/02/26/【HTTP】HTTPS 原理详解/" rel="prev" title="【HTTP】HTTPS 原理详解">
						 【HTTP】HTTPS 原理详解
				 </a>
		 </span>
		 
		 
		 <span class="art-item-right">
				 next：<a href="/2018/02/10/ASP.NET06/" rel="next" title="ASP.NET06">
						 ASP.NET06
				 </a><i class="icon icon-chevron-thin-right"></i>
		 </span>
		 
 </div>
 
</section>

</article>
<script>
window.subData = {
 title: 'ASP.NET MVC 视图',
 tools: true
}
</script>

      </div>
      <aside class='l_side'>
        
  <section class='m_widget about'>

<img class='avatar waves-image' src='/images/avatar.jpg' />

<div class='header'>luox78</div>
<div class='content'>
<div class='desc'>It's always not too late to learn</div>
</div>
</section>

  <section class='m_widget'>
        <div class='header'>田馥甄-你就不要想起我</div>
<div>
    <audio src="https://luox78.github.io/images/田馥甄-你就不要想起我.mp3" controls="controls" style="width:250px;">
        田馥甄-你就不要想起我
    </audio>
</div>
</section>

  <section class='m_widget categories'>
<div class='header'>Categories</div>
<div class='content'>
    
    <ul class="entry">
    
        <li><a class="flat-box" href="/categories/ASP-NET/"><div class='name'>ASP.NET</div><div class='badget'>9</div></a></li>
    
        <li><a class="flat-box" href="/categories/ASP-NET-MVC/"><div class='name'>ASP.NET MVC</div><div class='badget'>9</div></a></li>
    
        <li><a class="flat-box" href="/categories/C/"><div class='name'>C#</div><div class='badget'>17</div></a></li>
    
        <li><a class="flat-box" href="/categories/DailyLearning/"><div class='name'>DailyLearning</div><div class='badget'>6</div></a></li>
    
        <li><a class="flat-box" href="/categories/JQuery/"><div class='name'>JQuery</div><div class='badget'>3</div></a></li>
    
        <li><a class="flat-box" href="/categories/JavaScript/"><div class='name'>JavaScript</div><div class='badget'>21</div></a></li>
    
    </ul>
    
</div>
</section>

  
<div class="m_widget tagcloud">
    <div class="header">Tags</div>
    <div class='content'>
        <a href="/tags/ASP-NET-MVC5-编程实战/" style="font-size: 17px; color: #404040">ASP.NET MVC5 编程实战</a> <a href="/tags/Ajax/" style="font-size: 14px; color: #808080">Ajax</a> <a href="/tags/AjaxHelper/" style="font-size: 15.5px; color: #606060">AjaxHelper</a> <a href="/tags/C-特性/" style="font-size: 15.5px; color: #606060">C#特性</a> <a href="/tags/DI/" style="font-size: 14px; color: #808080">DI</a> <a href="/tags/Entity-Framework/" style="font-size: 15.5px; color: #606060">Entity Framework</a> <a href="/tags/HtmlHelper拓展/" style="font-size: 14px; color: #808080">HtmlHelper拓展</a> <a href="/tags/HttpModule/" style="font-size: 14px; color: #808080">HttpModule</a> <a href="/tags/HttpRequest/" style="font-size: 14px; color: #808080">HttpRequest</a> <a href="/tags/HttpResponse/" style="font-size: 14px; color: #808080">HttpResponse</a> <a href="/tags/HttpUtility/" style="font-size: 14px; color: #808080">HttpUtility</a> <a href="/tags/IIS请求流程/" style="font-size: 14px; color: #808080">IIS请求流程</a> <a href="/tags/IOC/" style="font-size: 15.5px; color: #606060">IOC</a> <a href="/tags/Json/" style="font-size: 14px; color: #808080">Json</a> <a href="/tags/LINQ/" style="font-size: 15.5px; color: #606060">LINQ</a> <a href="/tags/MD5/" style="font-size: 14px; color: #808080">MD5</a> <a href="/tags/Mvc校验/" style="font-size: 14px; color: #808080">Mvc校验</a> <a href="/tags/NOPI/" style="font-size: 14px; color: #808080">NOPI</a> <a href="/tags/SqlHelper/" style="font-size: 14px; color: #808080">SqlHelper</a> <a href="/tags/TryCatch/" style="font-size: 14px; color: #808080">TryCatch</a> <a href="/tags/areas/" style="font-size: 14px; color: #808080">areas</a> <a href="/tags/asp-net-mvc/" style="font-size: 14px; color: #808080">asp.net mvc</a> <a href="/tags/autofac/" style="font-size: 14px; color: #808080">autofac</a> <a href="/tags/bitwiseOperations/" style="font-size: 14px; color: #808080">bitwiseOperations</a> <a href="/tags/cache/" style="font-size: 15.5px; color: #606060">cache</a> <a href="/tags/database-first/" style="font-size: 14px; color: #808080">database first</a> <a href="/tags/entity-framework/" style="font-size: 15.5px; color: #606060">entity framework</a> <a href="/tags/entity-framework-designer/" style="font-size: 14px; color: #808080">entity framework designer</a> <a href="/tags/event/" style="font-size: 14px; color: #808080">event</a> <a href="/tags/filters/" style="font-size: 15.5px; color: #606060">filters</a> <a href="/tags/https/" style="font-size: 14px; color: #808080">https</a> <a href="/tags/http协议/" style="font-size: 14px; color: #808080">http协议</a> <a href="/tags/jQuery-Validate/" style="font-size: 14px; color: #808080">jQuery Validate</a> <a href="/tags/jQueryfoundation/" style="font-size: 17px; color: #404040">jQueryfoundation</a> <a href="/tags/jsfoundation/" style="font-size: 18.5px; color: #202020">jsfoundation</a> <a href="/tags/linq-to-ef/" style="font-size: 14px; color: #808080">linq to ef</a> <a href="/tags/log/" style="font-size: 14px; color: #808080">log</a> <a href="/tags/log4net/" style="font-size: 14px; color: #808080">log4net</a> <a href="/tags/model-first/" style="font-size: 14px; color: #808080">model first</a> <a href="/tags/path/" style="font-size: 14px; color: #808080">path</a> <a href="/tags/redis/" style="font-size: 14px; color: #808080">redis</a> <a href="/tags/request/" style="font-size: 14px; color: #808080">request</a> <a href="/tags/swagger/" style="font-size: 14px; color: #808080">swagger</a> <a href="/tags/thread/" style="font-size: 15.5px; color: #606060">thread</a> <a href="/tags/tips/" style="font-size: 14px; color: #808080">tips</a> <a href="/tags/viewstate/" style="font-size: 14px; color: #808080">viewstate</a> <a href="/tags/三层/" style="font-size: 15.5px; color: #606060">三层</a> <a href="/tags/分页/" style="font-size: 14px; color: #808080">分页</a> <a href="/tags/单例模式/" style="font-size: 14px; color: #808080">单例模式</a> <a href="/tags/发邮件/" style="font-size: 14px; color: #808080">发邮件</a> <a href="/tags/工厂模式/" style="font-size: 14px; color: #808080">工厂模式</a> <a href="/tags/数据库三范式/" style="font-size: 14px; color: #808080">数据库三范式</a> <a href="/tags/文件上传下载/" style="font-size: 14px; color: #808080">文件上传下载</a> <a href="/tags/模拟IIS/" style="font-size: 14px; color: #808080">模拟IIS</a> <a href="/tags/深入理解JS/" style="font-size: 20px; color: #000">深入理解JS</a> <a href="/tags/深入理解aspx/" style="font-size: 14px; color: #808080">深入理解aspx</a> <a href="/tags/简单三层/" style="font-size: 14px; color: #808080">简单三层</a> <a href="/tags/线程/" style="font-size: 14px; color: #808080">线程</a> <a href="/tags/缩略图/" style="font-size: 14px; color: #808080">缩略图</a> <a href="/tags/错误页/" style="font-size: 14px; color: #808080">错误页</a>
    </div>
</div>



  <section class='m_widget links'>
<div class='header'>Links</div>
<div class='content'>
    <ul class="entry">
    
        <li><a class="flat-box" target="_blank" href="https://github.com/luox78">
            <div class='name'>Github</div>
        </a></li>
    
        <li><a class="flat-box" target="_blank" href="https://www.baidu.com">
            <div class='name'>Baidu</div>
        </a></li>
    
    </ul>
</div>
</section>

      </aside>
    </div>
  </div>
  <footer id="footer" class="clearfix">

	<div class="social-wrapper">
  	
      
        <a href="https://github.com/luox78" class="social github"
          target="_blank" rel="external">
          <span class="icon icon-github"></span>
        </a>
      
        <a href="/" class="social twitter"
          target="_blank" rel="external">
          <span class="icon icon-twitter"></span>
        </a>
      
        <a href="/atom.xml" class="social rss"
          target="_blank" rel="external">
          <span class="icon icon-rss"></span>
        </a>
      
    
  </div>
  
  <div>
    <span>
        Powered by:<a href="https://hexo.io/" class="codename" target="_blank">
                       hexo
        </a>
    </span>
    <span> - </span>
    <span>
        Theme: <a href='https://github.com/stkevintan/hexo-theme-material-flow' class="codename" target="_blank">MaterialFlow</a> 
    </span>
    <span> - </span>
    <span id="busuanzi_container_site_pv">
        本站总访问量:
        <a href='http://ibruce.info/2015/04/04/busuanzi/' class="codename" target="_blank">
            <span id="busuanzi_value_site_pv"></span>
        </a>
    </span>
</div>
  
</footer>


  

<script src="//apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<script src='//cdn.bootcss.com/node-waves/0.7.5/waves.min.js'></script>
<script src="//cdn.bootcss.com/scrollReveal.js/3.3.2/scrollreveal.min.js"></script>
<script src="/js/jquery.fitvids.js"></script>
<script>
	var GOOGLE_CUSTOM_SEARCH_API_KEY = "";
	var GOOGLE_CUSTOM_SEARCH_ENGINE_ID = "";
	var ALGOLIA_API_KEY = "";
	var ALGOLIA_APP_ID = "";
	var ALGOLIA_INDEX_NAME = "";
  var AZURE_SERVICE_NAME = "";
  var AZURE_INDEX_NAME = "";
  var AZURE_QUERY_KEY = "";
  var BAIDU_API_ID = "";
  var SEARCH_SERVICE = "hexo";
  var ROOT = "/"||"/";
  if(!ROOT.endsWith('/'))ROOT += '/';
</script>
<script src="/js/search.js"></script>
<script src="/js/app.js"></script>
<!--隐藏不是主页的wiget-->
<script>
  if(document.location.href !== "https://luox78.github.io/" && document.location.href !== "https://luox78.github.io/archives/" && document.location.href !== "http://localhost:4000/"){
    var foo = document.getElementsByClassName("l_side");
    for (let index = 0; index < foo.length; index++) {
      foo[index].style.display="none";
    }
  }
  Waves.attach('.vbtn', ['waves-button', 'waves-float']);
  Waves.attach(".u-search-form", ['.waves-circle']);
  Waves.init();

  //添加tr显示效果
  $(".article-entry>table tbody tr:odd").css("backgroundColor","rgb(235,236,238)");
	$("#loading").fadeOut(1000);
  $("ol").attr("type",1);
</script>


</body>
</html>
