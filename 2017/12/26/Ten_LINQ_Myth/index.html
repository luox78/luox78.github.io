<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>LINQ | luox78</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="1 All LINQ queries must start with the ‘var’ keyword. In fact, the very purpose of the ‘var’ keyword is to start a LINQ query!123456string[] people = new [] &amp;#123; &amp;quot;Tom&amp;quot;, &amp;quot;Dick&amp;quot;, &amp;">
<meta name="keywords" content="LINQ">
<meta property="og:type" content="article">
<meta property="og:title" content="LINQ">
<meta property="og:url" content="http://yoursite.com/blog/2017/12/26/Ten_LINQ_Myth/index.html">
<meta property="og:site_name" content="luox78">
<meta property="og:description" content="1 All LINQ queries must start with the ‘var’ keyword. In fact, the very purpose of the ‘var’ keyword is to start a LINQ query!123456string[] people = new [] &amp;#123; &amp;quot;Tom&amp;quot;, &amp;quot;Dick&amp;quot;, &amp;">
<meta property="og:locale" content="zh">
<meta property="og:updated_time" content="2017-12-26T15:22:53.861Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="LINQ">
<meta name="twitter:description" content="1 All LINQ queries must start with the ‘var’ keyword. In fact, the very purpose of the ‘var’ keyword is to start a LINQ query!123456string[] people = new [] &amp;#123; &amp;quot;Tom&amp;quot;, &amp;quot;Dick&amp;quot;, &amp;">
  
    <link rel="alternate" href="/atom.xml" title="luox78" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">luox78</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Daily Learning</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com/blog"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Ten_LINQ_Myth" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/12/26/Ten_LINQ_Myth/" class="article-date">
  <time datetime="2017-12-26T14:34:53.555Z" itemprop="datePublished">2017-12-26</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/C/">C#</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      LINQ
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="1-All-LINQ-queries-must-start-with-the-‘var’-keyword-In-fact-the-very-purpose-of-the-‘var’-keyword-is-to-start-a-LINQ-query"><a href="#1-All-LINQ-queries-must-start-with-the-‘var’-keyword-In-fact-the-very-purpose-of-the-‘var’-keyword-is-to-start-a-LINQ-query" class="headerlink" title="1 All LINQ queries must start with the ‘var’ keyword. In fact, the very purpose of the ‘var’ keyword is to start a LINQ query!"></a>1 All LINQ queries must start with the ‘var’ keyword. In fact, the very purpose of the ‘var’ keyword is to start a LINQ query!</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">string[] people = new [] &#123; &quot;Tom&quot;, &quot;Dick&quot;, &quot;Harry&quot; &#125;;</span><br><span class="line">var filteredPeople = people.Where (p =&gt; p.Length &gt; 3); </span><br><span class="line">//is precisely equivalent to:</span><br><span class="line"></span><br><span class="line">string[] people = new [] &#123; &quot;Tom&quot;, &quot;Dick&quot;, &quot;Harry&quot; &#125;;</span><br><span class="line">IEnumerable&lt;string&gt; filteredPeople = people.Where (p =&gt; p.Length &gt; 3);</span><br></pre></td></tr></table></figure>
<h2 id="2-All-LINQ-queries-must-use-query-syntax"><a href="#2-All-LINQ-queries-must-use-query-syntax" class="headerlink" title="2 All LINQ queries must use query syntax."></a>2 All LINQ queries must use query syntax.</h2><ul>
<li><p><strong>lambda syntax</strong> </p>
</li>
<li><p><strong>query syntax</strong> </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">//Here&apos;s an example of lambda syntax:</span><br><span class="line"></span><br><span class="line">string[] people = new [] &#123; &quot;Tom&quot;, &quot;Dick&quot;, &quot;Harry&quot; &#125;;</span><br><span class="line">var filteredPeople = people.Where (p =&gt; p.Length &gt; 3); </span><br><span class="line">Here&apos;s the same thing expressed in query syntax:</span><br><span class="line"></span><br><span class="line">//string[] people = new [] &#123; &quot;Tom&quot;, &quot;Dick&quot;, &quot;Harry&quot; &#125;;</span><br><span class="line">var filteredPeople = from p in people where p.Length &gt; 3 select p;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="3-To-retrieve-all-customers-from-the-customer-table-you-must-perform-a-query-similar-to-the-following"><a href="#3-To-retrieve-all-customers-from-the-customer-table-you-must-perform-a-query-similar-to-the-following" class="headerlink" title="3 To retrieve all customers from the customer table, you must perform a query similar to the following:"></a>3 To retrieve all customers from the customer table, you must perform a query similar to the following:</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">The expression:</span><br><span class="line"></span><br><span class="line">from c in db.Customers select c </span><br><span class="line">is a frivolous query! You can simply go:</span><br><span class="line"></span><br><span class="line">db.Customers</span><br><span class="line">Similarly, the following LINQ to XML query:</span><br><span class="line"></span><br><span class="line">var xe = from e in myXDocument.Descendants (&quot;phone&quot;) select e;</span><br><span class="line">can be simplified to:</span><br><span class="line"></span><br><span class="line">var xe = myXDocument.Descendants (&quot;phone&quot;);</span><br><span class="line">And this:</span><br><span class="line"></span><br><span class="line">Customer customer = (from c in db.Customers where c.ID == 123 select c)</span><br><span class="line">                    .Single();</span><br><span class="line">can be simplified to:</span><br><span class="line"></span><br><span class="line">Customer customer = db.Customers.Single (c =&gt; c.ID == 123);</span><br></pre></td></tr></table></figure>
<h2 id="4-A-LINQ-to-SQL-or-EF-query-will-be-executed-in-one-round-trip-only-if-the-query-was-built-in-a-single-step"><a href="#4-A-LINQ-to-SQL-or-EF-query-will-be-executed-in-one-round-trip-only-if-the-query-was-built-in-a-single-step" class="headerlink" title="4 A LINQ to SQL or EF query will be executed in one round-trip only if the query was built in a single step."></a>4 A LINQ to SQL or EF query will be executed in one round-trip only if the query was built in a single step.</h2><p>LINQ follows a lazy evaluation model, which means queries execute not when constructed, but when enumerated. This means you can build up a query in as many steps as you like, and it won’t actually hit the server until you eventually start consuming the results.</p>
<p>For instance, the following query retrieves the names of all customers whose name starts with the letter ‘A’, and who have made at least two purchases. We build this query in three steps:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">var query = db.Customers.Where (c =&gt; c.Name.StartsWith (&quot;A&quot;));</span><br><span class="line">query = query.Where (c =&gt; c.Purchases.Count() &gt;= 2);</span><br><span class="line">var result = query.Select (c =&gt; c.Name);</span><br><span class="line"></span><br><span class="line">foreach (string name in result)   // Only now is the query executed!</span><br><span class="line">   Console.WriteLine (name);</span><br></pre></td></tr></table></figure></p>
<h2 id="5-Because-SQL-emits-flat-result-sets-LINQ-queries-must-be-structured-to-emit-flat-result-sets-too"><a href="#5-Because-SQL-emits-flat-result-sets-LINQ-queries-must-be-structured-to-emit-flat-result-sets-too" class="headerlink" title="5 Because SQL emits flat result sets, LINQ queries must be structured to emit flat result sets, too."></a>5 Because SQL emits flat result sets, LINQ queries must be structured to emit flat result sets, too.</h2><p>For example, if you want to retrieve the names of customers in the state of WA along with all their purchases, you can simply do the following:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from c in db.Customers</span><br><span class="line">where c.State == &quot;WA&quot;</span><br><span class="line">select new</span><br><span class="line">&#123;</span><br><span class="line">   c.Name,</span><br><span class="line">   c.Purchases    // An EntitySet (collection)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<p>The hierarchical result from this query is much easier to work with than a flat result set!</p>
<p>We can achieve the same result without association properties as follows:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">from c in db.Customers</span><br><span class="line">where c.State == &quot;WA&quot;</span><br><span class="line">select new</span><br><span class="line">&#123;</span><br><span class="line">   c.Name,</span><br><span class="line">   Purchases = db.Purchases.Where (p =&gt; p.CustomerID == c.ID)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/blog/2017/12/26/Ten_LINQ_Myth/" data-id="cjbp44k3i000580jxyaiky7zt" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/LINQ/">LINQ</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2017/12/27/JavaScript01/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          初识JavaScript
        
      </div>
    </a>
  
  
    <a href="/2017/12/26/CS6/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">C#6 特性</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/C/">C#</a><span class="category-list-count">3</span></li><li class="category-list-item"><a class="category-list-link" href="/categories/JavaScript/">JavaScript</a><span class="category-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/C-特性/">C#特性</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LINQ/">LINQ</a><span class="tag-list-count">1</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a><span class="archive-list-count">5</span></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/12/27/JavaScript01/">初识JavaScript</a>
          </li>
        
          <li>
            <a href="/2017/12/26/Ten_LINQ_Myth/">LINQ</a>
          </li>
        
          <li>
            <a href="/2017/12/26/CS6/">C#6 特性</a>
          </li>
        
          <li>
            <a href="/2017/12/26/CS7/">C#7 特性</a>
          </li>
        
          <li>
            <a href="/2017/12/25/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 luox78<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>